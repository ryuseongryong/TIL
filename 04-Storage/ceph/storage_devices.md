- https://docs.ceph.com/en/latest/rados/configuration/storage-devices/

# Storage Devices
- Ceph OSDs (Object Storage Daemons)는 Ceph에 대부분의 데이터를 저장합니다. 일반적으로 각 OSD는 단일 저장 장치로 백업됩니다. 이 장치는 기존의 하드 디스크(HDD) 또는 솔리드 스테이트 디스크(SSD)일 수 있습니다. 예를 들어 대부분의 데이터는 HDD, 일부 메타데이터는 SSD(또는 SSD의 파티션)를 사용하는 등 여러 장치를 조합하여 OSD를 백업할 수도 있습니다. 클러스터의 OSD 개수는 일반적으로 저장할 데이터의 양, 각 저장 장치의 크기, 지정된 중복성 수준 및 유형(복제 또는 삭제 코딩)에 따라 결정됩니다.
- Ceph Monitor 데몬은 중요한 클러스터 상태를 관리합니다. 여기에는 클러스터 구성원 및 인증 정보가 포함됩니다. 소규모 클러스터에서는 모니터 데이터베이스를 저장하는 데 몇 기가바이트의 스토리지만 필요합니다. 그러나 대규모 클러스터에서는 모니터 데이터베이스의 크기가 수십 기가바이트에서 수백 기가바이트에 달할 수 있습니다.
- Ceph Manager 데몬은 모니터 데몬과 함께 실행되어 추가 모니터링을 제공하고 외부 모니터링 및 관리 시스템에 대한 인터페이스를 제공합니다.

## OSD Back Ends
- OSD가 저장하는 데이터를 관리하는 방법에는 두 가지가 있습니다. Luminous 12.2.z 릴리스부터 기본(및 권장) 백엔드는 BlueStore입니다. Luminous 릴리스 이전에는 기본(그리고 유일한) 백엔드가 파일스토어였습니다.

### Bluestore
BlueStore는 Ceph OSD 워크로드를 위한 디스크의 데이터 관리를 위해 특별히 설계된 특수 목적 스토리지 백엔드입니다. BlueStore의 설계는 10년간의 파일스토어 OSD 지원 및 관리 경험을 기반으로 합니다.

BlueStore의 주요 기능은 다음과 같습니다:

저장 장치 직접 관리. BlueStore는 원시 블록 장치 또는 파티션을 사용합니다. 따라서 성능을 제한하거나 복잡성을 가중시킬 수 있는 추상화 계층(예: XFS와 같은 로컬 파일 시스템)이 개입하지 않습니다.

RocksDB로 메타데이터 관리. 디스크의 블록 위치에 대한 개체 이름 매핑을 비롯한 내부 메타데이터를 관리하기 위해 RocksDB의 키/값 데이터베이스가 내장되어 있습니다.

전체 데이터 및 메타데이터 체크섬. 기본적으로 BlueStore에 기록된 모든 데이터와 메타데이터는 하나 이상의 체크섬으로 보호됩니다. 데이터나 메타데이터는 확인되지 않고 디스크에서 읽히거나 사용자에게 반환되지 않습니다.

인라인 압축. 데이터를 디스크에 쓰기 전에 선택적으로 압축할 수 있습니다.

다중 장치 메타데이터 계층화. BlueStore에서는 내부 저널(미리 쓰기 로그)을 별도의 고속 장치(예: SSD, NVMe 또는 NVDIMM)에 기록하여 성능을 향상시킬 수 있습니다. 상당한 양의 더 빠른 스토리지를 사용할 수 있는 경우 내부 메타데이터를 더 빠른 장치에 저장할 수 있습니다.

효율적인 쓰기 시 복사. RBD 및 CephFS 스냅샷은 BlueStore에서 효율적으로 구현되는 복사본-온-쓰기 복제 메커니즘에 의존합니다. 따라서 일반 스냅샷과 삭제 코드 풀(효율적인 2단계 커밋을 구현하기 위해 복제에 의존하는) 모두에서 효율적인 I/O를 제공합니다.

### Filestore
파일 저장소는 Reef 릴리스에서 더 이상 사용되지 않으며 더 이상 지원되지 않습니다.

FileStore는 Ceph에 객체를 저장하는 레거시 접근 방식입니다. 일부 메타데이터를 위해 표준 파일 시스템(일반적으로 XFS)과 키/값 데이터베이스(기존에는 LevelDB, 현재는 RocksDB)를 함께 사용합니다.

FileStore는 충분한 테스트를 거쳤으며 프로덕션 환경에서 널리 사용되고 있습니다. 하지만 전반적인 설계와 객체 데이터 저장을 위한 기존 파일 시스템에 대한 의존으로 인해 많은 성능 결함이 있습니다.

FileStore는 대부분의 POSIX 호환 파일 시스템(btrfs 및 ext4 포함)에서 작동할 수 있지만, Ceph에서는 XFS 파일 시스템만 사용하는 것이 좋습니다. btrfs와 ext4 모두 알려진 버그와 결함이 있으며, 이를 사용하면 데이터가 손실될 수 있습니다. 기본적으로 모든 Ceph 프로비저닝 도구는 XFS를 사용합니다.

