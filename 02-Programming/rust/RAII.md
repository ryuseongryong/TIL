# RAII(rust에서 소유자 할당 해제할 때 사용되는 패턴)

- https://en.cppreference.com/w/cpp/language/raii
- Resource Acquisition Is Initialization(자원 획득 초기화) or RAII는 사용하기 전에 획득해야 하는 리소스(할당된 힙 메모리, 실행된 스레드, 열린 소켓, 열린 파일, 잠기 뮤텍스, 디스크 공간, 데이터베이스 연결 등 한정된 공급으로 존재하는 모든 것)의 수명 주기를 객체의 수명에 묶는 C++ 프로그램이 기법이다.
- RAII는 객체에 액세스할 수 있는 모든 함수가 리소스를 사용할 수 있도록 보장한다.(리소스 가용성은 클래스 불변성이므로 중복 런타임 테스트가 필요하지 않음)
- 또한 제어하는 객체의 수명이 끝나면 모든 리소스가 획득한 순서의 역순으로 해제되도록 보장한다. 마찬가지로 리소스 획득에 실패하면(생성자가 예외와 함께 종료됨), 완전히 구성된 모든 멤버와 기본 하위 객체가 획득한 모든 리소스가 초기화 순서의 역순으로 해제된다. 이는 핵심 언어 기능(객체 수명, 범위 종료, 초기화 순서, 스택 언와인딩)을 활용하여 리소스 누수를 없애고 예외의 안전성을 보장한다.
- 이 기술의 다른 이름은 범위 종료로 인해 RAII 객체의 수명이 종료되는 기본 사용 사례의 이름 따서 Scope-Bound Resource Management(SBRM) 범위 바운드 리소스 관리이다.

## Summary
- 각 리소스를 클래스로 캡슐화
    - 생성자는 리소스를 획득하고 모든 클래스 불변성을 설정하거나 그렇게 할 수 없는 경우 예외를 던짐
    - 소멸자는 리소스를 해제하고 예외를 던지지 않음
- 항상 자동 저장 기간이나 임시 저장 기간이 있는 RAII 클래스의 인스턴스를 통해 자원을 사용함
    - 자동 저장 기간이나 임시 수명 자체가 있거나
    - 자동 또는 임시 객체의 수명에 의해 제한되는 수명을 가진다.
- Move Semantics을 사용하면 리소스 안전성을 유지하면서 오브젝트 간, 범위 간, 스레드 안팎에서 리소스 소유권을 안전하게 이전할 수 있다.
