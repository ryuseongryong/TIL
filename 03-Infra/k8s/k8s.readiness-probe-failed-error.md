# K8s Readiness Probe Failed Error

- https://www.codemotion.com/magazine/devops/cloud/k8s-readiness-probe-failed-error/

## What Is a Readiness Probe Failed Error?

준비 프로브 실패 오류란 무엇인가요?
준비 프로브는 분산된 특성으로 인해 쿠버네티스 아키텍처에서 중요한 역할을 한다. 이는 쿠버네티스에서 파드 내의 컨테이너가 들어오는 트래픽을 수락하고 요청을 제공할 준비가 되었는지 여부를 확인하기 위해 사용되는 진단 검사이다. 컨테이너가 작업할 준비가 된 시기와 로드 밸런싱에 포함할 시기를 결정하는 데 도움이 되는 구성 가능한 메커니즘입니다.

파드 내의 컨테이너가 구성된 준비 상태 프로브 검사를 통과하지 못하면 준비 상태 오류가 발생한다. 이 오류는 컨테이너가 아직 들어오는 트래픽이나 요청을 수신하고 서비스할 준비가 되지 않았음을 나타낸다. 쿠버네티스는 이 오류를 감지하면 문제가 있는 컨테이너로 트래픽 라우팅을 중지하고 준비성 프로브 검사를 통과하여 컨테이너가 준비될 때까지 기다린다.

## Why Do Readiness Probes Fail?
응답 지연 및 연쇄적인 장애를 비롯한 다양한 이유로 Kubernetes의 준비 프로브가 실패할 수 있습니다. 이는 Kubernetes 클러스터의 여러 움직이는 부분에 영향을 미칠 수 있는 문제를 식별하고 해결하는 Kubernetes 문제 해결의 일반적인 과제를 보여줍니다. 다음은 이 두 가지 시나리오에 대한 간략한 개요입니다:

### Delayed Response
지연 응답은 컨테이너화된 애플리케이션이 구성된 시간 초과 기간보다 준비 프로브에 응답하는 데 시간이 오래 걸리는 경우 발생합니다. 이는 다음과 같은 다양한 요인으로 인해 발생할 수 있습니다:

- 애플리케이션 시작이 느립니다: 애플리케이션을 초기화하고 요청을 처리할 준비가 되는 데 더 많은 시간이 필요할 수 있으며, 이로 인해 준비 프로브가 시간 초과될 수 있습니다.
- 리소스 경합: 리소스가 제한되어 있거나 리소스 사용량이 많은 노드에서 컨테이너가 실행 중일 수 있으며, 이로 인해 응답 시간이 지연될 수 있습니다. 이로 인해 준비 프로브 검사에 실패할 수 있습니다.
- 애플리케이션 부하가 높은 경우: 애플리케이션에 트래픽이 갑자기 급증하거나 리소스 집약적인 작업을 처리하는 중일 수 있으며, 이로 인해 애플리케이션이 느려지고 응답이 없을 수 있습니다.

지연된 응답 문제를 해결하려면, 준비 프로브 구성에서 시간아웃초 매개변수를 늘리거나 애플리케이션을 최적화하여 더 빠르게 시작하고 성능을 개선할 수 있습니다. 이 자세한 블로그 게시물에서 Kubernetes 성능 문제에 대해 자세히 알아보세요.

### Cascading Failures
계단식 장애는 시스템 한 부분의 문제가 다른 부분으로 전파되어 시스템 전체에 일련의 장애를 일으킬 때 발생합니다. Kubernetes 및 준비 프로브의 맥락에서는 다음과 같은 경우에 발생할 수 있습니다:

- 종속 서비스가 실패한다: 컨테이너가 다른 서비스나 구성 요소에 의존하는 경우 해당 구성 요소에 장애가 발생하면 종속 컨테이너의 준비 프로브도 장애를 일으킬 수 있습니다.
- 로드 밸런싱 또는 네트워크 정책이 잘못 구성된 경우: 네트워크 또는 부하 분산 구성이 잘못되면 컨테이너에 연결하거나 트래픽을 라우팅하는 데 실패하여 준비 프로브가 실패할 수 있습니다.
- 클러스터 전체 리소스 고갈: 전체 Kubernetes 클러스터의 리소스가 부족하면 클러스터 전반의 여러 컨테이너가 준비 프로브에 실패하여 연쇄적인 장애로 이어질 수 있습니다.

계단식 장애를 완화하려면 애플리케이션에 적절한 오류 처리, 시간 초과 설정 및 회로 차단기 패턴이 있는지 확인하세요. 또한 클러스터 리소스를 효과적으로 모니터링하고 관리하여 리소스 고갈을 방지하세요.

## 8 Steps to Diagnose and Fix Kubernetes Readiness Probe Failed Errors

Kubernetes 준비 상태 프로브 실패 오류를 해결하려면 컨테이너, 애플리케이션 또는 프로브 구성과 관련된 문제를 식별하고 해결하기 위한 체계적인 접근 방식이 필요합니다.

1. 준비 프로브 구성을 검토한다: Kubernetes 배포 또는 파드 구성 내에서 준비 프로브 구성을 주의 깊게 검토하는 것부터 시작하세요. 준비 프로브에 올바른 유형(HTTP, TCP 또는 Exec), 올바른 경로 또는 포트, 적절한 타임아웃 및 초기 지연 값과 같은 적절한 파라미터가 있는지 확인합니다. 잘못된 구성은 컨테이너 준비 상태를 평가할 때 오탐으로 이어질 수 있습니다.

2. 로그를 검사하세요: 컨테이너 로그와 애플리케이션 로그를 모두 검사하여 애플리케이션 시작, 구성 또는 작동과 관련된 문제를 파악하세요. 로그는 애플리케이션 오류, 실패한 종속성 연결 또는 준비 상태 프로브가 실패할 수 있는 기타 문제에 대한 중요한 정보를 제공할 수 있다. 컨테이너 로그에 액세스하려면 kubectl 로그를 사용하고, 자세한 내용은 애플리케이션별 로깅 메커니즘을 참조한다.

3. 네트워크 문제를 확인한다: DNS 확인, 방화벽 제한 또는 네트워크 지연과 같은 네트워크 관련 문제가 준비 프로브에 영향을 미칠 수 있다. 애플리케이션이 필요한 외부 서비스에 연결할 수 있는지 확인하고, 네트워크 정책이나 방화벽이 컨테이너와 준비 프로브 엔드포인트 간의 트래픽을 허용하는지 확인하세요.

4. 시간 제한 값을 조정합니다: 애플리케이션을 시작하거나 초기화하는 데 준비 프로브에 대해 구성된 시간 제한 기간보다 오래 걸릴 수 있습니다. 이러한 경우, 프로브 구성에서 시간 초과 값(timeoutSeconds 및 initialDelaySeconds)을 늘려 애플리케이션이 준비될 수 있는 충분한 시간을 확보하는 것을 고려하세요.

5. 애플리케이션을 디버그합니다: 구성, 로그 및 네트워크를 확인한 후에도 문제가 지속되면 애플리케이션 자체를 디버깅해야 할 수 있습니다. 여기에는 애플리케이션 코드 분석, 컨테이너 이미지 문제 확인, 애플리케이션의 런타임 환경 검사 등이 포함될 수 있습니다. 애플리케이션이 제대로 시작되지 않거나 작동하지 않는 근본적인 문제를 해결해야 합니다.

6. 종속성 검증: 애플리케이션에 필요한 모든 종속성을 사용할 수 있고 올바르게 구성되었는지 확인합니다. 여기에는 데이터베이스, 외부 서비스, 구성 파일 또는 애플리케이션이 의존하는 기타 리소스가 포함될 수 있습니다. 종속성이 누락되거나 잘못 구성된 경우 애플리케이션이 시작되지 않거나 예상대로 작동하지 않아 준비도 프로브가 실패할 수 있습니다.

7. 리소스 사용량을 모니터링합니다: CPU, 메모리 또는 디스크 공간 부족과 같은 리소스 제약으로 인해 애플리케이션이 올바르게 시작되거나 작동하지 않을 수 있습니다. 모니터링 도구와 kubectl describe를 사용하여 컨테이너의 리소스 사용량을 확인하고 구성된 리소스 제한과 비교한다. 필요한 경우 리소스 제한을 조정하여 애플리케이션을 실행하기에 충분한 리소스가 있는지 확인한다.

8. 애플리케이션을 업데이트한다: 애플리케이션의 알려진 문제로 인해 오류가 발생한 경우 문제를 해결하는 버전으로 업데이트합니다. 프로덕션 클러스터에 배포하기 전에 업데이트된 애플리케이션을 통제된 환경에서 테스트해야 합니다.

이러한 요소를 체계적으로 해결하면 Kubernetes 준비 프로브 실패 오류를 해결하고 준비 프로브가 컨테이너의 요청 처리 능력을 정확하게 반영하는지 확인할 수 있습니다. 이렇게 하면 Kubernetes 기반 애플리케이션 및 서비스의 안정성과 성능을 유지하는 데 도움이 됩니다.

## Conclusion
결론적으로, 쿠버네티스 준비 프로브 실패 오류는 파드 내의 컨테이너가 들어오는 트래픽을 수락하고 요청을 제공할 준비가 되지 않았다는 중요한 신호입니다. 응답 지연 및 연쇄적인 실패와 같은 이 오류의 원인을 이해하는 것은 Kubernetes에서 실행되는 강력하고 복원력 있는 애플리케이션을 유지 관리하는 데 필수적입니다.

애플리케이션 로그를 확인하고, 준비 프로브 구성을 검토하고, 애플리케이션 성능을 최적화하고, 종속성, 클러스터 리소스 및 네트워크 정책을 관리하면 이 오류를 효과적으로 해결하고 해결할 수 있습니다.

