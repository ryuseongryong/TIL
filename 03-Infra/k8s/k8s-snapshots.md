# Kubernetes snapshots: What are they and how to use them?
- https://blog.palark.com/kubernetes-snaphots-usage/

쿠버네티스에 스냅샷 컨트롤러가 도입되면서 이제 이 기능을 지원하는 CSI 드라이버와 클라우드 제공자를 위한 스냅샷을 생성할 수 있게 되었다.

이 API는 범용적이고 공급업체에 독립적이며, 쿠버네티스의 일반적인 특징이므로 특정 구현의 세부 사항을 다루지 않고도 살펴볼 수 있습니다. 스냅샷에 대해 자세히 살펴보고 스냅샷이 Kubernetes 사용자에게 어떤 이점을 제공할 수 있는지 알아보겠습니다.

## Introduction
먼저 스냅샷이 무엇인지 명확히 알아봅시다. 스냅샷은 특정 시점의 파일 시스템 상태를 말합니다. 스냅샷을 저장했다가 나중에 특정 상태를 복원하는 데 사용할 수 있습니다. 스냅샷을 만드는 과정은 거의 즉각적으로 이루어집니다. 스냅샷이 만들어지면 원본 파일 시스템에 대한 모든 변경 사항이 다른 블록에 기록됩니다.

스냅샷 데이터는 원본 데이터와 동일한 위치에 저장되므로 스냅샷은 백업을 대체할 수 없습니다. 동시에 라이브 데이터보다는 스냅샷을 기반으로 한 백업이 더 일관성이 높습니다. 스냅샷이 생성될 때 모든 데이터가 최신 상태로 유지되기 때문입니다.

스냅샷 컨트롤러(모든 CSI 드라이버의 범용 구성 요소)를 설치해야 하며, 스냅샷 기능이 작동하려면 Kubernetes 클러스터에 다음 CRD가 정의되어 있어야 합니다:

- VolumeSnapshotClass - 스냅샷을 위한 StorageClass에 해당한다.
- VolumeSnapshotContent - 스냅샷의 PV에 해당한다.
- VolumeSnapshot - 스냅샷을 위한 PVC에 해당한다.
또한 CSI 드라이버는 스냅샷 생성을 지원해야 하며 관련 csi-snapshotter 컨트롤러가 있어야 합니다.

## How do snapshots work in Kubernetes?
작동 논리는 간단합니다. VolumeSnapshotClass는 CSI 드라이버와 같은 스냅샷 생성 매개변수를 설명하는 여러 엔티티가 있습니다. 또한 스냅샷을 증분으로 만들지 여부와 스냅샷을 저장할 위치 등 추가 설정을 지정할 수도 있습니다.

볼륨스냅샷을 생성할 때는 스냅샷이 생성될 퍼시스턴트볼륨클레임을 지정해야 합니다.

스냅샷을 생성할 때 CSI 드라이버는 클러스터에 볼륨스냅샷컨텐츠 리소스를 생성하고 해당 매개변수(일반적으로 리소스 ID)를 설정합니다.

그런 다음, 스냅샷 컨트롤러는 PV 및 PVC와 마찬가지로 VolumeSnapshot을 VolumeSnapshotContent에 바인딩합니다.

새 퍼시스턴트볼륨을 생성할 때, 이전에 생성한 볼륨스냅샷을 데이터소스로 설정하여 해당 데이터를 사용할 수 있습니다.

